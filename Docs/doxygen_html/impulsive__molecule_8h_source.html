<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>My Project: E:/_PhD/00_PST_CURRENT/impulsive_molecule.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">E:/_PhD/00_PST_CURRENT/impulsive_molecule.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//***********************************************************************************************************************************************************************************</span></div>
<div class="line"><a name="l00002"></a><span class="lineno"><a class="line" href="class_impulsive___molecule.html">    2</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_impulsive___molecule.html">Impulsive_Molecule</a> : <span class="keyword">public</span> <a class="code" href="class_phasespace___molecule.html">Phasespace_Molecule</a></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;{</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        <span class="keywordtype">double</span> E_barrier; <span class="comment">//cm-1 //if this is non zero, an impulsive treatment will occur</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        <span class="keywordtype">bool</span> use_angle_distribution, write_TS_inertia_xyz;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;        <span class="keywordtype">unsigned</span> bend_mode; <span class="comment">//only used to identify how many quanta of the bend mode exist in the parent state (not sure this is nessesary as that number of quanta is before getting to the TS config, which will use energy so may not still have vibs still)</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        <span class="keywordtype">double</span> TS_reaction_coord_force_constant, TS_reaction_coord_reduced_mass; <span class="comment">//for Eckart tunneling (these apply to the parent, where the TS coordinates are defined)</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;        <span class="keywordtype">double</span> TS_bend_frequency, TS_bend_reduced_mass, TS_bend_arc_radius; <span class="comment">//for HO wavefunction (FOR NOW ... these apply to the parent, where the TS coordinates are defined) I THINK WE NEED TO RE THINK THIS FOR BIGGER MOLECULES!!</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        <span class="keywordtype">double</span> TS_frag1_equilibrium_angle, TS_frag2_equilibrium_angle;<span class="comment">//the TS angle between the breaking bond and the centre of mass of this fragment (this value applies to children, calculated)</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        <span class="keywordtype">double</span> TS_frag1_pivot_to_com_length, TS_frag2_pivot_to_com_length;<span class="comment">//the TS distance from the pivot atom to the centre of mass, for each fragment (TS defined once for parent)</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        <span class="keywordtype">double</span> TS_frag1_moment_of_inertia, TS_frag2_moment_of_inertia;<span class="comment">//the moment of inertia in the TS configuration, for each fragment (TS defined once for parent)</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        <span class="keywordtype">double</span> TS_frag1_kn_ratio, TS_frag2_kn_ratio;<span class="comment">//the value of cos(theta) where theta is the angle between the rotation and principal axes of rotation of the fragment due to the impulse</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        <span class="keywordtype">double</span> initial_velocity;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        <a class="code" href="class_impulsive___molecule.html">Impulsive_Molecule</a>(){};</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">void</span> construct();</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        <span class="keyword">virtual</span> <a class="code" href="class_impulsive___molecule.html">Impulsive_Molecule</a>* clone(){<span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_impulsive___molecule.html">Impulsive_Molecule</a>(*<span class="keyword">this</span>);};</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        <span class="keyword">virtual</span> ~<a class="code" href="class_impulsive___molecule.html">Impulsive_Molecule</a>(){};<span class="comment">//persistent_output &lt;&lt; endl &lt;&lt; &quot;Killing an Impulsive_Molecule!&quot; &lt;&lt; endl;};</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">void</span> parse_input(<span class="keyword">const</span> std::string &amp;file_name, <span class="keyword">const</span> std::string &amp;section_name);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        <span class="keywordtype">void</span> get_impulse_values(FILE *the_file, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;num_axis_atoms, <a class="code" href="class_geom___molecule.html">Geom_Molecule</a> *TS_geom, <span class="keyword">const</span> std::vector&lt;unsigned&gt; &amp;TS_frag_atoms, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;TS_this_frag_pivot_atom, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;TS_other_frag_pivot_atom, <span class="keywordtype">double</span> &amp;TS_equilibrium_angle, <span class="keywordtype">double</span> &amp;TS_pivot_to_com_length, <span class="keywordtype">double</span> &amp;TS_moment_of_inertia, <span class="keywordtype">double</span> &amp;TS_kn_ratio);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        <span class="keywordtype">void</span> <a class="code" href="class_impulsive___molecule.html#aac407e174c14432636ced91f96051ad7">get_impulse_nk</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;E_iRot, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;kn_ratio, <span class="keywordtype">unsigned</span> &amp;i_n, <span class="keywordtype">unsigned</span> &amp;i_k, <span class="keywordtype">double</span> &amp;i_E_nk) <span class="keyword">const</span>; <span class="comment">//works out which</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        <a class="code" href="class_impulsive___molecule.html">Impulsive_Molecule</a>(<span class="keyword">const</span> <a class="code" href="class_impulsive___molecule.html">Impulsive_Molecule</a> &amp;rhs);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <span class="keyword">friend</span> <span class="keyword">class </span>boost::serialization::access;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <span class="keyword">template</span>&lt;<span class="keyword">class</span> Archive&gt;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <span class="keywordtype">void</span> serialize(Archive &amp; ar, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> version)</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;            ar &amp; boost::serialization::base_object&lt;Phasespace_Molecule&gt;(*this);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;            ar &amp; E_barrier &amp; use_angle_distribution &amp; write_TS_inertia_xyz &amp; bend_mode &amp; TS_reaction_coord_force_constant &amp; TS_reaction_coord_reduced_mass &amp; TS_bend_frequency &amp; TS_bend_reduced_mass &amp; TS_bend_arc_radius;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;            ar &amp; TS_frag1_equilibrium_angle &amp; TS_frag2_equilibrium_angle &amp; TS_frag1_pivot_to_com_length &amp; TS_frag2_pivot_to_com_length &amp; TS_frag1_moment_of_inertia &amp; TS_frag2_moment_of_inertia &amp; TS_frag1_kn_ratio &amp; TS_frag2_kn_ratio &amp; initial_velocity;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        }</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;};</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keywordtype">void</span> Impulsive_Molecule::construct(){</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="class_phasespace___molecule.html#a07bd5934fa43a399c5fedfbf70832472">Phasespace_Molecule::construct</a>();</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    E_barrier=0;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    use_angle_distribution=write_TS_inertia_xyz=0;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    bend_mode=0;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    TS_reaction_coord_force_constant=TS_reaction_coord_reduced_mass=0;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    TS_bend_frequency=TS_bend_reduced_mass=TS_bend_arc_radius=0;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    TS_frag1_equilibrium_angle=TS_frag2_equilibrium_angle=TS_frag1_pivot_to_com_length=TS_frag2_pivot_to_com_length=TS_frag1_moment_of_inertia=TS_frag2_moment_of_inertia=TS_frag1_kn_ratio=TS_frag2_kn_ratio=0;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    initial_velocity=0;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;Impulsive_Molecule::Impulsive_Molecule(<span class="keyword">const</span> <a class="code" href="class_impulsive___molecule.html">Impulsive_Molecule</a> &amp;rhs) : <a class="code" href="class_phasespace___molecule.html">Phasespace_Molecule</a>(rhs){</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    E_barrier=rhs.E_barrier;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    use_angle_distribution=rhs.use_angle_distribution;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    write_TS_inertia_xyz=rhs.write_TS_inertia_xyz;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    bend_mode=rhs.bend_mode;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    TS_bend_frequency=rhs.TS_bend_frequency;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    TS_bend_reduced_mass=rhs.TS_bend_reduced_mass;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    TS_bend_arc_radius=rhs.TS_bend_arc_radius;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    TS_frag1_equilibrium_angle=rhs.TS_frag1_equilibrium_angle;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    TS_frag2_equilibrium_angle=rhs.TS_frag2_equilibrium_angle;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    TS_frag1_pivot_to_com_length=rhs.TS_frag1_pivot_to_com_length;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    TS_frag2_pivot_to_com_length=rhs.TS_frag2_pivot_to_com_length;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    TS_frag1_moment_of_inertia=rhs.TS_frag1_moment_of_inertia;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    TS_frag2_moment_of_inertia=rhs.TS_frag2_moment_of_inertia;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    TS_frag1_kn_ratio=rhs.TS_frag1_kn_ratio;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    TS_frag2_kn_ratio=rhs.TS_frag2_kn_ratio;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    TS_reaction_coord_force_constant=rhs.TS_reaction_coord_force_constant;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    TS_reaction_coord_reduced_mass=rhs.TS_reaction_coord_reduced_mass;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    initial_velocity=rhs.initial_velocity;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;}</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="keywordtype">void</span> Impulsive_Molecule::parse_input(<span class="keyword">const</span> std::string &amp;file_name, <span class="keyword">const</span> std::string &amp;section_name){</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="class_phasespace___molecule.html#a346671671df5aeeb207fb7f26967599d">Phasespace_Molecule::parse_input</a>(file_name, section_name); <span class="comment">//first parse the parent class&#39;s members</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> NO_SECTION=0;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> GENERAL=1;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> TS_ATOMS=2;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordtype">unsigned</span> read_state(NO_SECTION);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    std::string file_name_and_path(input_directory+file_name);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    std::ifstream infile(file_name_and_path.c_str());</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    std::string line, key, value, symbol;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordtype">double</span> ax, ay, az;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    std::vector&lt;unsigned&gt; TS_frag1_atoms, TS_frag2_atoms;<span class="comment">//the indicies for this fragment, as defined in the TS</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordtype">unsigned</span> TS_frag1_pivot_atom(0), TS_frag2_pivot_atom(0); <span class="comment">//the index of the atom of this fragment in the breaking bond, as defined in the TS atoms input</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="class_geom___molecule.html">Geom_Molecule</a> *TS_geom; <span class="comment">//will be created and used to derive some data from imput coordinates and then deleted</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    TS_geom=<span class="keyword">new</span> <a class="code" href="class_geom___molecule.html">Geom_Molecule</a>(section_name); <span class="comment">//if there is a barrier, there is a TS, so we need a Geom_Molecule</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="class_output___file.html">Output_File</a> xyz_file;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    std::string job_name;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordtype">unsigned</span> i, xyz_count, num_axis_atoms(6);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    semipersistent_output &lt;&lt; <span class="stringliteral">&quot;Impulsive_Molecule &quot;</span>&lt;&lt; number &lt;&lt;<span class="stringliteral">&quot; parsing&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    print_semipersistent_output();</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">if</span> (infile.is_open()) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordflow">while</span>(getline(infile,line)) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="keywordflow">if</span> (line.substr(0,2) != <span class="stringliteral">&quot;//&quot;</span>){ <span class="comment">//if this is not a comment line (we should ignore comment lines)</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                <span class="keywordflow">if</span> (line.substr(0,8) == <span class="stringliteral">&quot;--------&quot;</span>){ <span class="comment">//this is the start of a new section</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                    read_state=NO_SECTION; <span class="comment">//set to none first in case the section is not recognised by this parse routine</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                    <span class="keywordflow">if</span> (line.find( std::string(<span class="stringliteral">&quot;-&quot;</span>)+section_name+std::string(<span class="stringliteral">&quot;-&quot;</span>) ) != std::string::npos) read_state=GENERAL;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.find( std::string(<span class="stringliteral">&quot;-&quot;</span>)+section_name+std::string(<span class="stringliteral">&quot; TS ATOMS-&quot;</span>) ) != std::string::npos) read_state=TS_ATOMS;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                <span class="keywordflow">if</span> (read_state==GENERAL){</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                    read_key_value(line, key, value);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                    <span class="keywordflow">if</span> (key != <span class="stringliteral">&quot;&quot;</span>) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                        <span class="keywordflow">if</span> (key == <span class="stringliteral">&quot;barrier_energy&quot;</span>){</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                            E_barrier=atof(value.c_str());</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                        }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (key == <span class="stringliteral">&quot;bend_mode&quot;</span>) bend_mode=atoi(value.c_str());</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (key == <span class="stringliteral">&quot;use_angle_distribution&quot;</span>) use_angle_distribution=atoi(value.c_str());</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (key == <span class="stringliteral">&quot;write_TS_inertia_xyz&quot;</span>) write_TS_inertia_xyz=atoi(value.c_str());</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (key == <span class="stringliteral">&quot;TS_bend_frequency&quot;</span>) TS_bend_frequency=atof(value.c_str()); <span class="comment">//do we need more than one now???</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (key == <span class="stringliteral">&quot;TS_bend_reduced_mass&quot;</span>) TS_bend_reduced_mass=atof(value.c_str()); <span class="comment">//do we need more than one now???</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (key == <span class="stringliteral">&quot;TS_bend_arc_radius&quot;</span>) TS_bend_arc_radius=atof(value.c_str()); <span class="comment">//do we need more than one now???</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (key == <span class="stringliteral">&quot;TS_reaction_coord_force_constant&quot;</span>) TS_reaction_coord_force_constant=atof(value.c_str());</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (key == <span class="stringliteral">&quot;TS_reaction_coord_reduced_mass&quot;</span>) TS_reaction_coord_reduced_mass=atof(value.c_str());</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (key == <span class="stringliteral">&quot;TS_frag1_pivot_atom&quot;</span>) TS_frag1_pivot_atom=atoi(value.c_str());</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (key == <span class="stringliteral">&quot;TS_frag2_pivot_atom&quot;</span>) TS_frag2_pivot_atom=atoi(value.c_str());</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (key == <span class="stringliteral">&quot;TS_frag1_atoms&quot;</span>) read_index_list(value, TS_frag1_atoms);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (key == <span class="stringliteral">&quot;TS_frag2_atoms&quot;</span>) read_index_list(value, TS_frag2_atoms);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                    }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (read_state==TS_ATOMS){ <span class="comment">//if a barrier energy is defined, then TS Atoms must be defined in the file! The barrier energy must be defined before the atoms in the file!</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                    <span class="keywordflow">if</span> (E_barrier &amp;&amp; read_atom_value(line, symbol, ax, ay, az)) TS_geom-&gt;add_atom(symbol, ax, ay, az);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        infile.close();</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordflow">if</span> (E_barrier){ <span class="comment">//if there is a barrier defined then calculate the values required for the impulse calculation</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="keywordflow">if</span> (TS_frag1_atoms.size() &amp;&amp; TS_frag2_atoms.size() &amp;&amp; TS_geom-&gt;atoms.size()){ <span class="comment">//check that the atoms in each fragment have been assigned (there are lots more error checking things that we could/should eventually do here)</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                <span class="keywordflow">if</span> (write_TS_inertia_xyz){</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                    job_name=file_name;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                    job_name.erase(job_name.find_last_of(<span class="stringliteral">&quot;.&quot;</span>), std::string::npos);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                    xyz_file.set_output_directory(output_directory+job_name+<span class="stringliteral">&quot;/xyz/&quot;</span>);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                    xyz_file.open(section_name+<span class="stringliteral">&quot;_TS_inertia_axes.xyz&quot;</span>);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                    xyz_count=TS_geom-&gt;atoms.size();</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                    <span class="keywordflow">if</span> (TS_frag1_atoms.size()&gt;1) xyz_count+=1+(4*num_axis_atoms);<span class="comment">//for each fragment, +1 for COM and +(4*num_axis_atoms) 2 points either side for each axis, principal and rotation, repeated num_axis_atoms times along axis</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                    <span class="keywordflow">if</span> (TS_frag2_atoms.size()&gt;1) xyz_count+=1+(4*num_axis_atoms);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                    fprintf(xyz_file.fp,<span class="stringliteral">&quot;%d\ncomment: TS geometry with centre of mass and principal and rotation axes illustrated with additional atoms\n&quot;</span>,xyz_count);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                    <span class="keywordflow">for</span> (i=0; i&lt;TS_geom-&gt;atoms.size(); i++) fprintf(xyz_file.fp,<span class="stringliteral">&quot;%s   %e   %e   %e\n&quot;</span>, TS_geom-&gt;atoms[i].symbol.c_str(), TS_geom-&gt;atoms[i].coord[0], TS_geom-&gt;atoms[i].coord[1], TS_geom-&gt;atoms[i].coord[2]);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                <span class="keywordflow">if</span> (TS_frag1_atoms.size()&gt;1) get_impulse_values(xyz_file.fp, num_axis_atoms, TS_geom, TS_frag1_atoms, TS_frag1_pivot_atom, TS_frag2_pivot_atom, TS_frag1_equilibrium_angle, TS_frag1_pivot_to_com_length, TS_frag1_moment_of_inertia, TS_frag1_kn_ratio);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                <span class="keywordflow">if</span> (TS_frag2_atoms.size()&gt;1) get_impulse_values(xyz_file.fp, num_axis_atoms, TS_geom, TS_frag2_atoms, TS_frag2_pivot_atom, TS_frag1_pivot_atom, TS_frag2_equilibrium_angle, TS_frag2_pivot_to_com_length, TS_frag2_moment_of_inertia, TS_frag2_kn_ratio);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                <span class="keywordflow">if</span> (write_TS_inertia_xyz) xyz_file.close();</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                <span class="keywordflow">if</span> (!TS_frag1_atoms.size()) persistent_output&lt;&lt;<span class="stringliteral">&quot;ERROR: &quot;</span>&lt;&lt;section_name&lt;&lt;<span class="stringliteral">&quot; TS_frag1_atoms have not been defined in input!&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                <span class="keywordflow">if</span> (!TS_frag2_atoms.size()) persistent_output&lt;&lt;<span class="stringliteral">&quot;ERROR: &quot;</span>&lt;&lt;section_name&lt;&lt;<span class="stringliteral">&quot; TS_frag2_atoms have not been defined in input!&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                <span class="keywordflow">if</span> (!TS_geom-&gt;atoms.size()) persistent_output&lt;&lt;<span class="stringliteral">&quot;ERROR: --------&quot;</span>&lt;&lt;section_name&lt;&lt;<span class="stringliteral">&quot; TS ATOMS -------- have not been defined in input!&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                print_persistent_output();</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keyword">delete</span> TS_geom;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;}</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="keywordtype">void</span> Impulsive_Molecule::get_impulse_values(FILE *the_file, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;num_axis_atoms, <a class="code" href="class_geom___molecule.html">Geom_Molecule</a> *TS_geom, <span class="keyword">const</span> std::vector&lt;unsigned&gt; &amp;TS_frag_atoms,</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;TS_this_frag_pivot_atom, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;TS_other_frag_pivot_atom, <span class="keywordtype">double</span> &amp;TS_equilibrium_angle, <span class="keywordtype">double</span> &amp;TS_pivot_to_com_length,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                                            <span class="keywordtype">double</span> &amp;TS_moment_of_inertia, <span class="keywordtype">double</span> &amp;TS_kn_ratio){</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordtype">double</span> rot_princ_angle;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    std::vector&lt;Geom_Eigen_Data&gt; principal_inertia_data;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    std::vector&lt;double&gt; frag_com, bond_vector, com_vector, rot_vector, rot_hat, princ_hat;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordtype">unsigned</span> i;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    frag_com=TS_geom-&gt;get_sub_centre_of_mass_coordinates(TS_frag_atoms);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    TS_equilibrium_angle=TS_geom-&gt;get_angle(TS_other_frag_pivot_atom, TS_this_frag_pivot_atom, frag_com);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    bond_vector=TS_geom-&gt;get_vector(TS_this_frag_pivot_atom, TS_other_frag_pivot_atom);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    com_vector=TS_geom-&gt;get_vector(TS_this_frag_pivot_atom, frag_com);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    TS_pivot_to_com_length=vector_magnitude(com_vector);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    rot_vector=cross_product(bond_vector,com_vector,3);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    TS_moment_of_inertia=TS_geom-&gt;get_sub_inertia_axis_vector(TS_frag_atoms, frag_com, rot_vector);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    principal_inertia_data=TS_geom-&gt;get_sub_inertia_tensor(TS_frag_atoms, frag_com);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    rot_princ_angle=vector_angle(rot_vector, principal_inertia_data[2].vect); <span class="comment">//get the angle between the rotation axis and the principal axis</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    TS_kn_ratio=cos(rot_princ_angle);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">if</span> (write_TS_inertia_xyz){</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        rot_hat=vector_normalise(rot_vector);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        princ_hat=vector_normalise(principal_inertia_data[2].vect);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        fprintf(the_file,<span class="stringliteral">&quot;Si   %e   %e   %e\n&quot;</span>, frag_com[0], frag_com[1], frag_com[2]);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordflow">for</span> (i=0;i&lt;num_axis_atoms;i++){</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            fprintf(the_file,<span class="stringliteral">&quot;F   %e   %e   %e\n&quot;</span>, frag_com[0]+(princ_hat[0]*i), frag_com[1]+(princ_hat[1]*i), frag_com[2]+(princ_hat[2]*i));</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            fprintf(the_file,<span class="stringliteral">&quot;F   %e   %e   %e\n&quot;</span>, frag_com[0]+(-1*princ_hat[0]*i), frag_com[1]+(-1*princ_hat[1]*i), frag_com[2]+(-1*princ_hat[2]*i));</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            fprintf(the_file,<span class="stringliteral">&quot;Cl   %e   %e   %e\n&quot;</span>, frag_com[0]+(rot_hat[0]*i), frag_com[1]+(rot_hat[1]*i), frag_com[2]+(rot_hat[2]*i));</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            fprintf(the_file,<span class="stringliteral">&quot;Cl   %e   %e   %e\n&quot;</span>, frag_com[0]+(-1*rot_hat[0]*i), frag_com[1]+(-1*rot_hat[1]*i), frag_com[2]+(-1*rot_hat[2]*i));</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;}</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="class_impulsive___molecule.html#aac407e174c14432636ced91f96051ad7">  177</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_impulsive___molecule.html#aac407e174c14432636ced91f96051ad7">Impulsive_Molecule::get_impulse_nk</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;E_iRot, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;kn_ratio, <span class="keywordtype">unsigned</span> &amp;i_n, <span class="keywordtype">unsigned</span> &amp;i_k, <span class="keywordtype">double</span> &amp;i_E_nk)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordtype">unsigned</span> n_max, to_k, n, k;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordtype">double</span> E_nk, E_percent_error, nk_percent_error, this_total_percent_error, total_percent_error;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    total_percent_error=E_nk=i_E_nk=i_n=i_k=0; <span class="comment">//start with 0 and if there is a better fit these will be reset in the loop</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">if</span> (E_iRot&gt;0) total_percent_error=200;<span class="comment">//can&#39;t calculate deviation of kn_ratio from k/n as n=0 so the RMSE is just the energy difference for n=k=0, which will be 100% for non zero E_iRot ... we need 200 because two percent errors are added</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    n_max=get_n_max(E_iRot);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">for</span> (n=1;n&lt;=n_max;n++){<span class="comment">// from 1 because we don&#39;t want to divide by 0!</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">if</span> (linear) to_k=0;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordflow">else</span> to_k=n;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">for</span> (k=0;k&lt;=to_k;k++){</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            E_nk=<a class="code" href="class_phasespace___molecule.html#af0646f94d520e591903b8b9a91208366">get_E_nk</a>(n, k);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <span class="comment">//persistent_output&lt;&lt;endl&lt;&lt;&quot;n=&quot;&lt;&lt;n&lt;&lt;&quot; k=&quot;&lt;&lt;k&lt;&lt;&quot; &quot;;</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <span class="keywordflow">if</span> (E_nk&lt;=E_iRot){<span class="comment">//this state is within the available energy (this check is nesesary because get_E_nk() uses ceil to ensure nothing is omitted)</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                E_percent_error=100*(E_iRot-E_nk)/E_iRot;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                nk_percent_error=100*abs(kn_ratio-((<span class="keywordtype">double</span>)k/(<span class="keywordtype">double</span>)n))/kn_ratio;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                this_total_percent_error=E_percent_error+nk_percent_error;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                <span class="comment">//persistent_output&lt;&lt;E_nk&lt;&lt;&quot;&lt;=&quot;&lt;&lt;E_iRot&lt;&lt;&quot; this_total_percent_error=&quot;&lt;&lt;this_total_percent_error&lt;&lt;&quot; E_percent_error=&quot;&lt;&lt;E_percent_error&lt;&lt;&quot; nk_percent_error=&quot;&lt;&lt;nk_percent_error&lt;&lt;&quot; &quot;;</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                <span class="keywordflow">if</span> (this_total_percent_error&lt;=total_percent_error){<span class="comment">//smallest RMSE fit wins!</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                    total_percent_error=this_total_percent_error;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                    i_n=n;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                    i_k=k;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                    i_E_nk=E_nk;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                    <span class="comment">//persistent_output&lt;&lt;&quot;current_min_error &quot;;</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">//persistent_output&lt;&lt;endl&lt;&lt;&quot;chosen_n=&quot;&lt;&lt;i_n&lt;&lt;&quot; chosen_k=&quot;&lt;&lt;i_k&lt;&lt;&quot; E=&quot;&lt;&lt;i_E_nk&lt;&lt;endl&lt;&lt;endl;</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;}</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">//***********************************************************************************************************************************************************************************</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="ttc" id="class_phasespace___molecule_html_a346671671df5aeeb207fb7f26967599d"><div class="ttname"><a href="class_phasespace___molecule.html#a346671671df5aeeb207fb7f26967599d">Phasespace_Molecule::parse_input</a></div><div class="ttdeci">virtual void parse_input(const std::string &amp;file_name, const std::string &amp;section_name)</div><div class="ttdef"><b>Definition:</b> phasespace_molecule.h:258</div></div>
<div class="ttc" id="class_phasespace___molecule_html_a07bd5934fa43a399c5fedfbf70832472"><div class="ttname"><a href="class_phasespace___molecule.html#a07bd5934fa43a399c5fedfbf70832472">Phasespace_Molecule::construct</a></div><div class="ttdeci">virtual void construct()</div><div class="ttdef"><b>Definition:</b> phasespace_molecule.h:237</div></div>
<div class="ttc" id="class_phasespace___molecule_html"><div class="ttname"><a href="class_phasespace___molecule.html">Phasespace_Molecule</a></div><div class="ttdef"><b>Definition:</b> phasespace_molecule.h:151</div></div>
<div class="ttc" id="class_output___file_html"><div class="ttname"><a href="class_output___file.html">Output_File</a></div><div class="ttdef"><b>Definition:</b> misc.h:273</div></div>
<div class="ttc" id="class_phasespace___molecule_html_af0646f94d520e591903b8b9a91208366"><div class="ttname"><a href="class_phasespace___molecule.html#af0646f94d520e591903b8b9a91208366">Phasespace_Molecule::get_E_nk</a></div><div class="ttdeci">double get_E_nk(const unsigned N, const unsigned K) const </div><div class="ttdef"><b>Definition:</b> phasespace_molecule.h:409</div></div>
<div class="ttc" id="class_impulsive___molecule_html"><div class="ttname"><a href="class_impulsive___molecule.html">Impulsive_Molecule</a></div><div class="ttdef"><b>Definition:</b> impulsive_molecule.h:2</div></div>
<div class="ttc" id="class_impulsive___molecule_html_aac407e174c14432636ced91f96051ad7"><div class="ttname"><a href="class_impulsive___molecule.html#aac407e174c14432636ced91f96051ad7">Impulsive_Molecule::get_impulse_nk</a></div><div class="ttdeci">void get_impulse_nk(const double &amp;E_iRot, const double &amp;kn_ratio, unsigned &amp;i_n, unsigned &amp;i_k, double &amp;i_E_nk) const </div><div class="ttdef"><b>Definition:</b> impulsive_molecule.h:177</div></div>
<div class="ttc" id="class_geom___molecule_html"><div class="ttname"><a href="class_geom___molecule.html">Geom_Molecule</a></div><div class="ttdef"><b>Definition:</b> geom_molecule.h:16</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Mar 30 2015 15:46:03 for My Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
